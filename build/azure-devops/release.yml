trigger: 
- main
pr: none
    
name: 1.0$(Rev:.r)

stages:
- stage: BuildAndPublish
  jobs:
  - job: BuildLambda
    displayName: Build Azure DevOps Lambda
    pool:
      vmImage: ubuntu-18.04

    container: node:12-buster

    steps:
    - template: templates/build-and-publish-lambda.yml
      parameters:
        lambdaName: azdev-adapter-webhook

- stage: AWSCloudformation
  displayName: "AWS Cloudformation"
  dependsOn: []
  jobs:
  - job: ValidateTemplates
    displayName: Validate Templates
    pool:
      vmImage: windows-2019

    steps:
    - template: templates/validate-cf-templates.yml
